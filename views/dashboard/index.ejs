<%- include('../partials/navbar') %>

<% if (isLoggedIn) { %>
<div class="content-wrapper">
<% } %>

<%- include('../partials/flash') %>

<div class="container-fluid p-3">
    <!-- Welcome Section -->
    <div class="welcome-card mb-3">
        <h5 class="mb-1">Welcome back, <%= user.name %>! ðŸ‘‹</h5>
        <p class="text-white-50 small mb-0"><%- getRoleBadge(user.role) %></p>
    </div>

    <!-- Statistics Cards -->
    <div class="row g-3 mb-3">
        <div class="col-6">
            <div class="stat-card bg-primary">
                <div class="stat-icon">
                    <i class="bi bi-people-fill"></i>
                </div>
                <div class="stat-info">
                    <h3><%= stats.alumni %></h3>
                    <p>Alumni</p>
                </div>
            </div>
        </div>
        <div class="col-6">
            <div class="stat-card bg-success">
                <div class="stat-icon">
                    <i class="bi bi-person-badge"></i>
                </div>
                <div class="stat-info">
                    <h3><%= stats.students %></h3>
                    <p>Students</p>
                </div>
            </div>
        </div>
        <div class="col-6">
            <div class="stat-card bg-info">
                <div class="stat-icon">
                    <i class="bi bi-newspaper"></i>
                </div>
                <div class="stat-info">
                    <h3><%= stats.posts %></h3>
                    <p>Posts</p>
                </div>
            </div>
        </div>
        <div class="col-6">
            <div class="stat-card bg-warning">
                <div class="stat-icon">
                    <i class="bi bi-briefcase"></i>
                </div>
                <div class="stat-info">
                    <h3><%= stats.jobs %></h3>
                    <p>Jobs</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="section-header mb-3">
        <h6 class="mb-0"><i class="bi bi-lightning-fill text-warning me-2"></i>Quick Actions</h6>
    </div>
    
    <div class="row g-3 mb-4">
        <div class="col-6">
            <a href="/directory" class="quick-action-card">
                <i class="bi bi-search"></i>
                <span>Find Alumni</span>
            </a>
        </div>
        <div class="col-6">
            <a href="/jobs" class="quick-action-card">
                <i class="bi bi-briefcase-fill"></i>
                <span>Browse Jobs</span>
            </a>
        </div>
        <% if (user.role === 'alumni' || user.role === 'admin') { %>
        <div class="col-6">
            <a href="/newsfeed/create" class="quick-action-card">
                <i class="bi bi-plus-circle-fill"></i>
                <span>Create Post</span>
            </a>
        </div>
        <div class="col-6">
            <a href="/jobs/create" class="quick-action-card">
                <i class="bi bi-megaphone-fill"></i>
                <span>Post Job</span>
            </a>
        </div>
        <% } %>
    </div>

    <!-- Recent Updates -->
    <div class="section-header mb-3">
        <h6 class="mb-0"><i class="bi bi-clock-history text-info me-2"></i>Recent Updates</h6>
        <a href="/newsfeed" class="text-decoration-none small">View All</a>
    </div>

    <% if (recentPosts && recentPosts.length > 0) { %>
        <% recentPosts.forEach(post => { %>
        <div class="post-card mb-3">
            <div class="post-header">
                <div class="post-author">
                    <% if (post.profile_picture) { %>
                        <img src="/<%= post.profile_picture %>" alt="Profile">
                    <% } else { %>
                        <div class="avatar-placeholder">
                            <%= post.name.charAt(0).toUpperCase() %>
                        </div>
                    <% } %>
                    <div>
                        <strong><%= post.name %></strong>
                        <%- getRoleBadge(post.role) %>
                        <small class="text-muted d-block"><%= timeAgo(post.created_at) %></small>
                    </div>
                </div>
            </div>
            <div class="post-content">
                <p><%= post.content %></p>
                <% if (post.image) { %>
                    <img src="/<%= post.image %>" alt="Post image" class="post-image">
                <% } %>
            </div>
            <div class="post-footer">
                <button class="btn btn-sm btn-light">
                    <i class="bi bi-heart"></i> <%= post.likes_count %>
                </button>
                <button class="btn btn-sm btn-light">
                    <i class="bi bi-chat"></i> Comment
                </button>
                <button class="btn btn-sm btn-light">
                    <i class="bi bi-share"></i> Share
                </button>
            </div>
        </div>
        <% }); %>
    <% } else { %>
        <div class="empty-state">
            <i class="bi bi-inbox"></i>
            <p>No posts yet</p>
        </div>
    <% } %>
</div>

<% if (isLoggedIn) { %>
</div>
<%- include('../partials/bottom-nav') %>
<% } %>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="/js/app.js"></script>
